<!DOCTYPE html>
<html>
  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      document.getElementById("btn").addEventListener("click", async () => {
        const urlsearch = "http://localhost:3000/kapibara/";
        let exp = new Object();
        exp = {
          name: document.getElementById("name").value,
          Habitat: document.getElementById("habitat").value,
          pictureUrl: document.getElementById("picUrl").value,
          feature: document.getElementById("feture").value,
        };
        const response = await fetch("http://localhost:3000/kapibara", {
          method: "POST", //postでも動く
          body: JSON.stringify(exp),
          headers: {
            "Content-Type": "application/json",
          },
        });

        const data = await response.json();
        const statuscode = await response.status;

        if (statuscode === 201) {
          const createok = "<h1>登録成功！</h1>";
          let result = document.getElementById("result");
          let div = document.createElement("div");
          div.innerHTML = createok; //html要素に変換
          result.appendChild(div, result);
        } else if (statuscode === 400) {
          alert(data.errors[0].param + ":" + data.errors[0].msg);
        }
      });
    });
  </script>
  <head>
    <meta charset="utf-8" />
    <title>Profeel</title>
  </head>
  <body>
    <h2>新しい仲間の情報を入力してください</h2>

    <label>名前：</label
    ><input id="name" type="text" name="name" size="15" value="旅カピ" /> <br />
    <label>主な住処：</label
    ><input
      id="habitat"
      type="text"
      name="Habitat"
      size="30"
      value="on the bed at home"
    />
    <br />
    <label>写真：</label><input id="picUrl" type="text" name="pictureUrl"
    size="30" value=../picture/tabi.jpg/> <br />
    <label>特徴：</label
    ><input
      id="feture"
      type="text"
      name="feture"
      size="80"
      value="小さい体ゆえにカバンに潜り込んで各国を旅しているカピバラ。"
    />
    <br />
    <input id="btn" type="button" name="submit" value="登録" />
    <div id="result"></div>
  </body>
</html>
